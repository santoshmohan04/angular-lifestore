<div class="products-container">
  <mat-sidenav-container class="sidenav-container">
    <!-- Sidenav for Categories -->
    <mat-sidenav 
      #sidenav 
      [mode]="isMobile() ? 'over' : 'side'" 
      [opened]="!isMobile()"
      class="category-sidenav">
      <div class="sidenav-header">
        <h2>Categories</h2>
      </div>
      
      <mat-nav-list>
        @for(category of categories; track category.key) {
          <mat-list-item 
            (click)="selectCategory(category.key); isMobile() && sidenav.close()"
            [activated]="selectedCategory() === category.key"
            class="category-item">
            <mat-icon matListItemIcon>{{ category.icon }}</mat-icon>
            <span matListItemTitle>{{ category.name }}</span>
          </mat-list-item>
        }
      </mat-nav-list>
    </mat-sidenav>

    <!-- Main Content -->
    <mat-sidenav-content>
      <!-- Toolbar -->
      <div class="products-toolbar">
        <div class="toolbar-left">
          @if(isMobile()) {
            <button mat-icon-button (click)="sidenav.toggle()">
              <mat-icon>menu</mat-icon>
            </button>
          }
          <h1 class="products-title">
            @for(category of categories; track category.key) {
              @if(selectedCategory() === category.key) {
                {{ category.name }}
              }
            }
          </h1>
          <mat-chip-set>
            <mat-chip>{{ displayedProducts().length }} products</mat-chip>
          </mat-chip-set>
        </div>
        
        <div class="toolbar-right">
          <mat-form-field appearance="outline" class="sort-select">
            <mat-label>Sort by</mat-label>
            <mat-select 
              [value]="sortOption()" 
              (selectionChange)="updateSort($event.value)">
              @for(option of sortOptions; track option.value) {
                <mat-option [value]="option.value">{{ option.label }}</mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <!-- Loading State -->
      @if(isLoading()) {
        <div class="loading-container">
          <mat-spinner diameter="60"></mat-spinner>
          <p>Loading products...</p>
        </div>
      }

      <!-- Products Grid -->
      @if(!isLoading() && displayedProducts().length > 0) {
        <div class="products-grid">
          @for(product of displayedProducts(); track product.id) {
            <mat-card class="product-card">
              <div class="product-image-container">
                <img 
                  mat-card-image 
                  [src]="'assets/' + product.image" 
                  [alt]="product.name"
                  class="product-image"
                />
              </div>
              
              <mat-card-content class="product-content">
                <h3 class="product-name">{{ product.name }}</h3>
                <p class="product-price">â‚¹{{ product.price }}</p>
              </mat-card-content>
              
              <mat-card-actions class="product-actions">
                <button 
                  mat-raised-button 
                  color="primary" 
                  (click)="addtoCart(product)"
                  class="add-to-cart-btn">
                  <mat-icon>shopping_cart</mat-icon>
                  Add to Cart
                </button>
              </mat-card-actions>
            </mat-card>
          }
        </div>
      }

      <!-- Empty State -->
      @if(!isLoading() && displayedProducts().length === 0) {
        <div class="empty-state">
          <mat-icon class="empty-icon">inventory_2</mat-icon>
          <h2>No products found</h2>
          <p>Try selecting a different category</p>
        </div>
      }
    </mat-sidenav-content>
  </mat-sidenav-container>
</div>
